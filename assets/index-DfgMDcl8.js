import{H as y,d as T,n as f,I as P,q as B,B as x,J as q,r as s,o as $,b as A,w as o,g as E,e as t,k as b,i as U,E as h,c as N,h as W}from"./index-BGduB5Uj.js";const j=()=>y.get("/admin/acl/permission"),z=(d,l={})=>d.id?y.put("/admin/acl/permission/update",d,l):y.post("/admin/acl/permission/save",d,l),I=(d,l={})=>y.delete(`/admin/acl/permission/remove/${d}`,l),L={class:"dialog-footer"},M=T({__name:"DialogAddOrUpdate",props:{action:{type:String,default:"A"},rowData:{type:Object,default:()=>({})}},emits:["update:dialogVisible","dialog-confirm"],setup(d,{emit:l}){const v=l,a=d,n=f(!1);let _=P(()=>a.action==="A"?"新增子菜单":"修改菜单");B(()=>{n.value=!0,a.action=="U"&&Object.assign(i,a.rowData)});const w=f(),i=x({name:"",code:""}),C=q("formValidate"),D=x({name:C({required:!0}),code:C({required:!0})}),r=async()=>{await w.value.validate();let u={pid:a.rowData.id,...i};try{const e=await z(u,{showLoading:!0});e.code===200?(h.success((a.action==="A"?"新增":"修改")+"成功"),n.value=!1,v("dialog-confirm")):h.error(e.message)}catch{}},m=()=>{v("update:dialogVisible",!1)};return(u,e)=>{const V=s("el-input"),k=s("el-form-item"),c=s("el-form"),g=s("el-button"),O=s("el-dialog");return $(),A(O,{modelValue:n.value,"onUpdate:modelValue":e[3]||(e[3]=p=>n.value=p),title:U(_),width:"500px","show-close":!1,onClose:m},{footer:o(()=>[E("span",L,[t(g,{onClick:e[2]||(e[2]=p=>n.value=!1)},{default:o(()=>[b("关闭")]),_:1}),t(g,{type:"primary",onClick:r},{default:o(()=>[b(" 确认 ")]),_:1})])]),default:o(()=>[t(c,{ref_key:"formRef",ref:w,model:i,rules:D,"label-width":"100px","status-icon":"",class:"form-wrapper"},{default:o(()=>[t(k,{label:"菜单名称",prop:"name"},{default:o(()=>[t(V,{modelValue:i.name,"onUpdate:modelValue":e[0]||(e[0]=p=>i.name=p)},null,8,["modelValue"])]),_:1}),t(k,{label:"权限编码",prop:"code"},{default:o(()=>[t(V,{modelValue:i.code,"onUpdate:modelValue":e[1]||(e[1]=p=>i.code=p)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),R=T({name:"Permission"}),H=T({...R,setup(d){const l=f(),v=x({requestFn:j,columns:[{label:"菜单名称",prop:"name",minWidth:150,align:"left"},{label:"权限编码",prop:"code",minWidth:150},{label:"创建时间",prop:"createTime",minWidth:150,"show-overflow-tooltip":!0},{label:"操作",prop:"operation",minWidth:250,slot:"operation"}]}),a=f(!1);let n=f(""),_=f();const w=r=>{a.value=!0,n.value="A",_.value=r},i=r=>{a.value=!0,n.value="U",_.value=r},C=async r=>{if(r.id)try{(await I(r.id,{showLoading:!0})).code===200?(h.success("删除成功"),l.value.getTableData()):h.error("删除失败")}catch{}},D=()=>{l.value.getTableData()};return(r,m)=>{const u=s("el-button"),e=s("el-popconfirm"),V=s("TableCreate"),k=s("el-card");return $(),N("div",null,[t(k,{class:"box-card"},{default:o(()=>[t(V,{ref_key:"tableDom",ref:l,tableOptions:v,showPagination:!1,"row-key":"id","expand-row-keys":["1"]},{operation:o(({scope:c})=>[t(u,{size:"small",type:"primary",onClick:g=>w(c.row)},{default:o(()=>[b(" 添加子菜单 ")]),_:2},1032,["onClick"]),t(u,{size:"small",type:"primary",onClick:g=>i(c.row)},{default:o(()=>[b(" 修改 ")]),_:2},1032,["onClick"]),t(e,{title:`你确定要删除${c.row.name}及其子菜单?`,width:"260px",onConfirm:g=>C(c.row)},{reference:o(()=>[t(u,{type:"danger",size:"small"},{default:o(()=>[b(" 删除 ")]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1},8,["tableOptions"])]),_:1}),a.value?($(),A(M,{key:0,dialogVisible:a.value,"onUpdate:dialogVisible":m[0]||(m[0]=c=>a.value=c),rowData:U(_),action:U(n),onDialogConfirm:D},null,8,["dialogVisible","rowData","action"])):W("",!0)])}}});export{H as default};
