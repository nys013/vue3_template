import{D as y,d as A,n as f,G as h,q,z as $,H as z,r as d,o as U,b as O,w as o,g as B,e as t,k as b,i as T,E as D,c as E,h as N}from"./index-DscIuvd5.js";const W=()=>y.get("/admin/acl/permission"),j=(m,n={})=>m.id?y.put("/admin/acl/permission/update",m,n):y.post("/admin/acl/permission/save",m,n),L=(m,n={})=>y.delete(`/admin/acl/permission/remove/${m}`,n),M={class:"dialog-footer"},R=A({__name:"DialogAddOrUpdate",props:{action:{type:String,default:"A"},rowData:{type:Object,default:()=>({})}},emits:["update:dialogVisible","dialog-confirm"],setup(m,{emit:n}){const v=n,l=m,i=f(!1);let _=h(()=>l.action==="A"?"新增子菜单":"修改菜单");q(()=>{i.value=!0,l.action=="U"&&Object.assign(r,l.rowData)});const w=f(),r=$({name:"",code:""}),C=z("formValidate"),x=$({name:C({required:!0}),code:C({required:!0})}),s=async()=>{await w.value.validate();let c={pid:l.rowData.id,...r};try{const e=await j(c,{showLoading:!0});e.code===200?(D.success((l.action==="A"?"新增":"修改")+"成功"),i.value=!1,v("dialog-confirm")):D.error(e.message)}catch{}},a=()=>{v("update:dialogVisible",!1)};return(c,e)=>{const V=d("el-input"),k=d("el-form-item"),u=d("el-form"),g=d("el-button"),P=d("el-dialog");return U(),O(P,{modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=p=>i.value=p),title:T(_),width:"500px","show-close":!1,onClose:a},{footer:o(()=>[B("span",M,[t(g,{onClick:e[2]||(e[2]=p=>i.value=!1)},{default:o(()=>e[4]||(e[4]=[b("关闭")])),_:1}),t(g,{type:"primary",onClick:s},{default:o(()=>e[5]||(e[5]=[b(" 确认 ")])),_:1})])]),default:o(()=>[t(u,{ref_key:"formRef",ref:w,model:r,rules:x,"label-width":"100px","status-icon":"",class:"form-wrapper"},{default:o(()=>[t(k,{label:"菜单名称",prop:"name"},{default:o(()=>[t(V,{modelValue:r.name,"onUpdate:modelValue":e[0]||(e[0]=p=>r.name=p)},null,8,["modelValue"])]),_:1}),t(k,{label:"权限编码",prop:"code"},{default:o(()=>[t(V,{modelValue:r.code,"onUpdate:modelValue":e[1]||(e[1]=p=>r.code=p)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),F=A({name:"Permission"}),H=A({...F,setup(m){const n=f(),v=$({requestFn:W,columns:[{label:"菜单名称",prop:"name",minWidth:150,align:"left"},{label:"权限编码",prop:"code",minWidth:150},{label:"创建时间",prop:"createTime",minWidth:150,"show-overflow-tooltip":!0},{label:"操作",prop:"operation",minWidth:250,slot:"operation"}]}),l=f(!1);let i=f(""),_=f();const w=s=>{l.value=!0,i.value="A",_.value=s},r=s=>{l.value=!0,i.value="U",_.value=s},C=async s=>{if(s.id)try{(await L(s.id,{showLoading:!0})).code===200?(D.success("删除成功"),n.value.getTableData()):D.error("删除失败")}catch{}},x=()=>{n.value.getTableData()};return(s,a)=>{const c=d("el-button"),e=d("el-popconfirm"),V=d("TableCreate"),k=d("el-card");return U(),E("div",null,[t(k,{class:"box-card"},{default:o(()=>[t(V,{ref_key:"tableDom",ref:n,tableOptions:v,showPagination:!1,"row-key":"id","expand-row-keys":["1"]},{operation:o(({scope:u})=>[t(c,{size:"small",type:"primary",onClick:g=>w(u.row)},{default:o(()=>a[1]||(a[1]=[b(" 添加子菜单 ")])),_:2},1032,["onClick"]),t(c,{size:"small",type:"primary",onClick:g=>r(u.row)},{default:o(()=>a[2]||(a[2]=[b(" 修改 ")])),_:2},1032,["onClick"]),t(e,{title:`你确定要删除${u.row.name}及其子菜单?`,width:"260px",onConfirm:g=>C(u.row)},{reference:o(()=>[t(c,{type:"danger",size:"small"},{default:o(()=>a[3]||(a[3]=[b(" 删除 ")])),_:1})]),_:2},1032,["title","onConfirm"])]),_:1},8,["tableOptions"])]),_:1}),l.value?(U(),O(R,{key:0,dialogVisible:l.value,"onUpdate:dialogVisible":a[0]||(a[0]=u=>l.value=u),rowData:T(_),action:T(i),onDialogConfirm:x},null,8,["dialogVisible","rowData","action"])):N("",!0)])}}});export{H as default};
